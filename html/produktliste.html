<!DOCTYPE html>
<html lang="de">

<head>
  <link rel="stylesheet" href="Stylesheet.css">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Handwäsche</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <link rel="stylesheet" href="../css/bootstrap.css">
  <link rel="stylesheet" href="../css/Stylesheet.css">
  <script src="../js/Verkauf1Client.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.bundle.min.js"></script>
  <script src="../js/tools.js"></script>
</head>

<body>
  <div class="pointer">
    <div id="Verkauf1_Logo" class="logo" onclick="window.location.href='start.html'">
      <img src="../img/DeluxeCar.png" />
    </div>
  </div>
  <nav id="Kategorieliste">
    <!--navbar -->
  </nav>

  <div class="currentposition">
    <h7 id="Verkauf1_Handwäsche">
      Handwäsche
    </h7>
  </div>

  <div class="pointer1">
    <div class="container wasdienedgeschafthaben">
      <div class="row" id="produktliste">
        <!-- produktdaten -->
      </div>
    </div>
  </div>
  <hr>
  <!-- footer -->


  <div class="footer-basic">
    <footer>
      <p>Marcus, Fabian, Leon, Caspar © 2020 Webanwendung2 <br> <a href="Impressum.html">Impressum</a> | <a href="Kontakt.html">Kontakt</a> </p>
    </footer>
  </div>


  <script>
    $(document).ready(function() {

      //AJAX for the navbar----------------------------------------------------------------------------------------------------------------
      $.ajax({
        url: "http://localhost:8000/api/produktkategorie/alle",
        method: "get",
        dataType: "json"
      }).done(function(response) {
        //console.log(response.daten[0].name);

        var tmp = '';
        tmp += '<ul>';
        tmp += '<li><a class="navi" href="start.html">Startseite</a></li>';

        for (i = 0; i < response.daten.length; i++) {
          tmp += '<li><a class="navi" href="produktliste.html?kategorie=' + response.daten[i].id + '">' + response.daten[i].bezeichnung + '</a>';
          tmp += '</li>';
        }

        tmp += '<li><a class="navi" href="Warenkorb.html">Warenkorb</a></li></ul>';


        $('#Kategorieliste').html(tmp);
      }).fail(function(jqXHR, statusText, error) {
        console.log("Response Code: " + jqXHR.status + " - Fehlermeldung: " + jqXHR.responseText);
        alert("Ein Fehler ist aufgetreten");
      });


      //AJAX for products-------------------------------------------------------------------------------------------------------------------
      $.ajax({
        url: "http://localhost:8000/api/produkt/vonKategorie/" + $.urlParam('kategorie'),
        method: "get",
        dataType: "json"
      }).done(function(response) {
        console.log(response.daten[0].bruttopreis);

        var tmp = '';

        for (i = 0; i < response.daten.length; i++) {
          tmp += '<div class="col-md-3 col-sm-6">';
          tmp += '<div class="product-grid2">';
          tmp += '<div class="product-image2">';
          tmp += '<a href="' + response.daten[i].name + '.html">';
          tmp += '<img class="pic-1" src ="' + response.daten[i].bilder[0].bildpfad + '">';
          if (response.daten[i].bilder.length == 1) { //Some pics use only 1 picture! --> Check it!
            tmp += '<img class="pic-2" src ="' + response.daten[i].bilder[0].bildpfad + '">';
          } else {
            tmp += '<img class="pic-2" src ="' + response.daten[i].bilder[1].bildpfad + '">';
          }
          tmp += '</a>';
          tmp += '<a class="add-to-cart" href="' + response.daten[i].name + '.html">' + response.daten[i].beschreibungklein + '</a>';
          tmp += '</div>';
          tmp += '<div class="product-content">';
          tmp += '<h3 class="title"><a href="' + response.daten[i].name + '.html">' + response.daten[i].name + '</br>' + response.daten[i].bruttopreis.toString().replace(".", ",") + ' €</br>inkl. MwSt.</a></h3>';
          tmp += '<input id="userInput" step="1" data-step-max="10" type="number" value="0" data-decimals="0" min="0" max="360" class="col-4" />';
          tmp += '<button id="addProduct1" onclick="Input1()">In den Warenkorb</button>';
          tmp += '</div>';
          tmp += '</div>';
          tmp += '</div>';

        } // end for

        // produktdetails.html?produkt=234

        $('#produktliste').html(tmp);
      }).fail(function(jqXHR, statusText, error) {
        console.log("Response Code: " + jqXHR.status + " - Fehlermeldung: " + jqXHR.responseText);
        alert("Ein Fehler ist aufgetreten");
      });



    });
  </script>


</body>

</html>
